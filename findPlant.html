
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì˜¤í›„ì˜ ì‹ë¬¼ | ì‹ë¬¼ ìƒë‹´ì†Œ</title>
  <meta name="description" content="ì´ˆë³´ ì‹ì§‘ì‚¬ë¥¼ ìœ„í•œ ë°˜ë ¤ì‹ë¬¼ ì§„ë‹¨ê³¼ ì´ë¦„ ì°¾ê¸°, ì¶”ì²œì„ ì‚¬ì§„ìœ¼ë¡œ ì‰½ê²Œ í•´ê²°!">
  <meta name="keywords" content="ì˜¤í›„ì˜ ì‹ë¬¼, ì‹ë¬¼, í…Œë¼ë¦¬ì›€, ì¸í…Œë¦¬ì–´í™”ë¶„, ë¯¸ë‹ˆì‹ë¬¼, í™”ë¶„, ë°˜ë ¤ì‹ë¬¼, ì‹ë¬¼ì¶”ì²œ, ì‹ë¬¼ìƒë‹´, í”Œëœí…Œë¦¬ì–´, ì‹ì§‘ì‚¬">
  <meta property="og:type" content="website">
  <meta property="og:title" content="ì˜¤í›„ì˜ ì‹ë¬¼ | ì¸í…Œë¦¬ì–´í™”ë¶„ & ë¯¸ë‹ˆì‹ë¬¼ ì¶”ì²œ">
  <meta property="og:description" content="ì´ˆë³´ ì‹ì§‘ì‚¬ë¥¼ ìœ„í•œ ë°˜ë ¤ì‹ë¬¼ ì§„ë‹¨ê³¼ ì´ë¦„ ì°¾ê¸°, ì¶”ì²œì„ ì‚¬ì§„ìœ¼ë¡œ ì‰½ê²Œ í•´ê²°!">
  <meta property="og:image" content="https://plantnoon.com/">
  <meta property="og:url" content="https://plantnoon.com/">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ì˜¤í›„ì˜ ì‹ë¬¼ | ì‹ë¬¼ ì¶”ì²œ, í…Œë¼ë¦¬ì›€, ë¯¸ë‹ˆì‹ë¬¼, í™”ë¶„ ìƒë‹´ì†Œ">
  <meta name="twitter:description" content="ì´ˆë³´ ì‹ì§‘ì‚¬ë¥¼ ìœ„í•œ ë°˜ë ¤ì‹ë¬¼ ì§„ë‹¨ê³¼ ì´ë¦„ ì°¾ê¸°, ì¶”ì²œì„ ì‚¬ì§„ìœ¼ë¡œ ì‰½ê²Œ í•´ê²°!">
  <meta name="twitter:image" content="https://plantnoon.com/logo.png">

    <link rel="icon" href="logo.png?v=2" type="image/png">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="navigation.css">

<style>
/* ë³€ìˆ˜ ì„¤ì • */
:root {
    --bg-cream: #FBF8F3;
    --chat-bg: #ffffff;
    --plant-bubble-bg: #e8f5e9;
    --user-bubble-bg: #6B7B61;
    --user-bubble-text: #ffffff;
    --text-dark: #4E4A42;
    --border-light: #eaeaea;
}


main {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 100px 20px 40px;
}

/* ì±—ë´‡ ì»¨í…Œì´ë„ˆ */
.chat-container {
    width: 100%;
    max-width: 600px;
    height: 70vh;
    max-height: 700px;
    background: var(--chat-bg);
    border-radius: 24px;
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    display: flex;
    flex-direction: column;
}

/* ë©”ì‹œì§€ ì˜ì—­ */
.message-area {
    flex-grow: 1;
    padding: 24px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
}

/* ë§í’ì„  ìŠ¤íƒ€ì¼ */
.message-bubble {
    padding: 12px 18px;
    border-radius: 20px;
    margin-bottom: 12px;
    max-width: 80%;
    line-height: 1.6;
    opacity: 0;
    transform: translateY(10px);
    animation: popIn 0.4s forwards;
}

@keyframes popIn {
    to { opacity: 1; transform: translateY(0); }
}

/* ì‹ë¬¼(ë´‡) ë§í’ì„  */
.plant-message {
    background: var(--plant-bubble-bg);
    color: var(--text-dark);
    border-bottom-left-radius: 4px;
    align-self: flex-start;
}

/* ì‚¬ìš©ì ë§í’ì„  */
.user-message {
    background: var(--user-bubble-bg);
    color: var(--user-bubble-text);
    border-bottom-right-radius: 4px;
    align-self: flex-end;
}

/* ë‹µë³€ ë²„íŠ¼ ì˜ì—­ */
.option-area {
    padding: 16px;
    border-top: 1px solid var(--border-light);
    background: var(--chat-bg);
    border-bottom-left-radius: 24px;
    border-bottom-right-radius: 24px;
}

.option-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    opacity: 0;
    animation: popIn 0.5s 0.3s forwards;
}

.option-buttons button {
    padding: 10px 16px;
    border: 1px solid var(--user-bubble-bg);
    color: var(--user-bubble-bg);
    background: #fff;
    border-radius: 30px;
    cursor: pointer;
    font-size: 0.9rem;
    font-weight: 500;
    transition: all 0.2s ease;
}
.option-buttons button:hover {
    background: var(--user-bubble-bg);
    color: #fff;
}

/* íƒ€ì´í•‘ ì¸ë””ì¼€ì´í„° */
.typing-indicator {
    display: flex;
    align-items: center;
    padding: 12px 18px;
}
.typing-indicator span {
    height: 8px;
    width: 8px;
    background-color: #ccc;
    border-radius: 50%;
    display: inline-block;
    margin: 0 2px;
    animation: bounce 1.2s infinite;
}
.typing-indicator span:nth-of-type(2) { animation-delay: 0.2s; }
.typing-indicator span:nth-of-type(3) { animation-delay: 0.4s; }

@keyframes bounce {
    0%, 60%, 100% { transform: translateY(0); }
    30% { transform: translateY(-6px); }
}

/* ê²°ê³¼ ì¹´ë“œ */
/* ê²°ê³¼ ì¹´ë“œë¥¼ í´ë¦­ ê°€ëŠ¥í•˜ê²Œ ë³´ì´ë„ë¡ ìˆ˜ì • */
.result-card-wrapper {
    background: #fff;
    border-radius: 12px;
    padding: 16px;
    margin-top: 8px;
    border: 1px solid var(--border-light);
    cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•¨ì„ ë‚˜íƒ€ë‚´ëŠ” ì»¤ì„œ */
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.result-card-wrapper:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.08);
}
.result-card-wrapper img {
    width: 100%;
    height: 150px;
    object-fit: cover;
    border-radius: 8px;
    margin-bottom: 12px;
}
.result-card-wrapper h3 { margin: 0 0 4px; font-family: 'Playfair Display', serif; }
.result-card-wrapper p { margin: 0; font-size: 0.9rem; color: #777; }



/* â¬‡ï¸ ì•„ë˜ ë‚´ìš©ì„ <style> íƒœê·¸ ì•ˆì— ì¶”ê°€í•˜ì„¸ìš” â¬‡ï¸ */

/* ë™ì  ìºë¦­í„° */
.plant-character {
    position: fixed;
    bottom: 40px;
    left: calc(50% - 400px); /* ì±—ë´‡ ì™¼ìª½ì— ìœ„ì¹˜í•˜ë„ë¡ ì¡°ì • */
    z-index: 10;
    transition: transform 0.3s ease;
}

.pot {
    width: 100px;
    height: 90px;
    background: #D4A373; /* í™ìƒ‰ ê³„ì—´ */
    border-radius: 0 0 40px 40px;
    position: relative;
}
.pot::before { /* í™”ë¶„ ìœ—ë¶€ë¶„ ì¥ì‹ */
    content: '';
    position: absolute;
    top: 0;
    left: -10px;
    width: 120px;
    height: 20px;
    background: #bb8a5a;
    border-radius: 10px;
}

.eyes {
    position: absolute;
    bottom: 35px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 15px;
}
.eye {
    width: 10px;
    height: 10px;
    background: #4E4A42;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.plant {
    position: absolute;
    bottom: 70px;
    left: 50%;
    transform-origin: bottom center;
}

.leaf {
    width: 20px;
    height: 50px;
    background: #81a373; /* ì‹ë¬¼ ì ìƒ‰ */
    border-radius: 50% 50% 0 50%;
    position: absolute;
    bottom: 0;
    transform-origin: bottom center;
}

.leaf-1 {
    transform: rotate(-15deg) translateX(-10px);
}
.leaf-2 {
    transform: rotate(5deg);
    height: 60px;
}
.leaf-3 {
    transform: rotate(20deg) translateX(10px);
}

/* ìºë¦­í„° ìƒíƒœë³„ ì• ë‹ˆë©”ì´ì…˜ */
@keyframes idle-sway {
    0%, 100% { transform: rotate(0deg); }
    50% { transform: rotate(3deg); }
}

@keyframes thinking-bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
}

@keyframes happy-jump {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-15px) scale(1.05) rotate(5deg); }
}

/* ìƒíƒœ í´ë˜ìŠ¤ */
.plant-character.idle .plant {
    animation: idle-sway 4s ease-in-out infinite;
}

.plant-character.thinking .plant {
    animation: thinking-bounce 1.5s ease-in-out infinite;
}
.plant-character.thinking .eye {
    height: 3px; /* ëˆˆì„ ê°€ëŠ˜ê²Œ ë– ì„œ ìƒê°í•˜ëŠ” í‘œì • */
    transform: translateY(4px);
}

.plant-character.happy .plant {
    animation: happy-jump 0.8s ease-in-out infinite;
}
.plant-character.happy .eye {
    height: 12px;
    width: 12px;
    transform: translateY(-2px);
}


/* ì‹ë¬¼ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ */
.modal-wrapper {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.4s ease, visibility 0.4s ease;
}
.modal-wrapper.visible {
    opacity: 1;
    visibility: visible;
}

.plant-modal {
    background: var(--bg-cream);
    padding: 20px; /* ë‚´ë¶€ ì—¬ë°±ì„ ì‚´ì§ ì¤„ì…ë‹ˆë‹¤. */
    border-radius: 20px;
    width: 90%;
    max-width: 520px; /* ìµœëŒ€ ë„ˆë¹„ë¥¼ ì¤„ì—¬ ë” ì‘ê²Œ ë§Œë“­ë‹ˆë‹¤. */
    position: relative;
    box-shadow: 0 20px 50px rgba(0,0,0,0.2);
    transform: scale(0.9);
    transition: transform 0.4s ease;
}

.plant-modal img {
    width: 100%;
    height: 200px; /* ì´ë¯¸ì§€ ë†’ì´ë¥¼ ì¤„ì—¬ ëª¨ë‹¬ ì „ì²´ í¬ê¸°ë¥¼ ì¤„ì…ë‹ˆë‹¤. */
    object-fit: cover;
    border-radius: 12px;
    margin-bottom: 20px;
}
.modal-wrapper.visible .plant-modal {
    transform: scale(1);
}

.plant-modal .close-button {
    position: absolute;
    top: 15px;
    right: 15px;
    background: none;
    border: none;
    font-size: 2rem;
    color: var(--text-dark);
    cursor: pointer;
}

.plant-modal .plant-info h2 {
    font-family: 'Playfair Display', serif;
    font-size: 2rem;
    color: var(--user-bubble-bg);
    margin: 0 0 10px;
}
.plant-modal .plant-info p {
    font-size: 1rem;
    line-height: 1.7;
    margin-bottom: 24px;
    color: var(--text-dark); /* [ìˆ˜ì •] ìƒì„¸ ì„¤ëª… í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì¶”ê°€ */
}
.plant-modal .care-guide h3 {
    margin-bottom: 12px;
    font-size: 1.2rem;
    border-bottom: 2px solid var(--border-light);
    padding-bottom: 8px;
    color: var(--text-dark); /* [ìˆ˜ì •] 'ê´€ë¦¬ ë°©ë²•' ì œëª© ìƒ‰ìƒ ì¶”ê°€ */
}
.plant-modal .care-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
}
.care-item {
    background: #fff;
    padding: 12px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    font-size: 0.95rem;
    color: var(--text-dark); /* [ìˆ˜ì •] ê´€ë¦¬ í•­ëª© í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì¶”ê°€ */
}
.care-item span {
    font-size: 1.5rem;
    margin-right: 10px;
}

.difficulty-rating {
    margin-bottom: 16px;
    font-size: 1.5rem;
}

.difficulty-rating .star.filled {
    color: #FFC700; /* ì±„ì›Œì§„ ë³„ ìƒ‰ìƒ (ë…¸ë€ìƒ‰ ê³„ì—´) */
}

.difficulty-rating .star.empty {
    color: #E0E0E0; /* ë¹„ì–´ìˆëŠ” ë³„ ìƒ‰ìƒ (ë°ì€ íšŒìƒ‰) */
}
/* â¬‡ï¸ ì•„ë˜ ë‚´ìš©ì„ <style> íƒœê·¸ ì•ˆì— ì¶”ê°€í•˜ì„¸ìš” â¬‡ï¸ */

.difficulty-label {
    color: var(--text-dark);
    font-size: 1rem;
    font-weight: 500;
    margin-right: 8px;
    vertical-align: middle; /* ë³„ê³¼ ì„¸ë¡œ ì •ë ¬ì„ ë§ì¶¥ë‹ˆë‹¤ */
}

/* ë³„ ì•„ì´ì½˜ì˜ ì„¸ë¡œ ì •ë ¬ë„ ë¯¸ì„¸ ì¡°ì •í•©ë‹ˆë‹¤. */
.difficulty-rating .star {
    vertical-align: middle;
}

/* í™”ë©´ì´ ì‘ì•„ì§ˆ ë•Œ ìºë¦­í„° ìœ„ì¹˜ ë° í¬ê¸° ì¡°ì • */
@media (max-width: 820px) {
 .plant-character {
 left: auto; /* ê¸°ì¡´ left ì†ì„± ë¬´íš¨í™” */
 right: 20px; /* ì˜¤ë¥¸ìª½ì—ì„œ 20px ìœ„ì¹˜ */
 bottom: 80px; /* ì•„ë˜ì—ì„œ 20px ìœ„ì¹˜ */
 transform: scale(0.8); /* í¬ê¸°ë¥¼ 80%ë¡œ ì¶•ì†Œ */
        transform-origin: bottom right; /* ì˜¤ë¥¸ìª½ ì•„ë˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì•„ì§€ë„ë¡ ì„¤ì • */
 }

   main {
    padding-bottom: 90px !important; /* ë„¤ë¹„ê²Œì´ì…˜ ë†’ì´+ì—¬ìœ  */
  }
  .chat-container {
    max-width: 100vw;
    min-height: 60vh;
    margin-bottom: 80px; /* í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜ ë§Œí¼ ì—¬ìœ  ê³µê°„ */
  }
  .message-area {
    padding-bottom: 35px; /* ì˜µì…˜ë²„íŠ¼ì´ ê²¹ì¹˜ì§€ ì•Šê²Œ */
  }
}

/* í‘¸í„° ì „ìš© ìŠ¤íƒ€ì¼ */
    .main-footer {
        background-color: var(--bg-cream);
        color: var(--text-dark);
        padding: 50px 20px 20px;
        border-top: 1px solid #e9e6e6;
        font-size: 0.95rem;
    }
    .footer-container {
        max-width: 900px;
        margin: 0 auto;
        display: flex;
        flex-wrap: wrap;
        justify-content: space-between;
        gap: 40px;
        padding-bottom: 40px;
        border-bottom: 1px solid #e0dcd1;
    }
    .footer-about {
        max-width: 300px;
    }
    .footer-about .logo {
        font-family: var(--font-serif);
        font-size: 1.8rem;
        font-weight: 600;
        color: var(--primary-green);
        text-decoration: none;
        margin-bottom: 12px;
        display: inline-block;
    }
    .footer-about p {
        line-height: 1.7;
        color: #7a7a5c;
        margin-bottom: 20px;
    }
    .footer-social a {
        color: #7a7a5c;
        text-decoration: none;
        margin-right: 18px;
        transition: color 0.2s;
    }
    .footer-social a:hover {
        color: var(--primary-green);
    }
    .footer-links-group {
        display: flex;
        gap: 50px;
    }
    .footer-links h4 {
        font-family: var(--font-serif);
        color: var(--text-dark);
        font-size: 1.2rem;
        margin-bottom: 15px;
    }
    .footer-links ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }
    .footer-links li {
        margin-bottom: 10px;
    }
    .footer-links a {
        color: #7a7a5c;
        text-decoration: none;
        transition: color 0.2s;
    }
    .footer-links a:hover {
        color: var(--primary-green);
        text-decoration: underline;
    }
    .footer-bottom {
        text-align: center;
        padding-top: 20px;
        font-size: 0.85rem;
        color: #b2a97e;
    }
    /* í‘¸í„° í•˜ë‹¨ ë° ì‚¬ì—…ì ì •ë³´ ìŠ¤íƒ€ì¼ */
.business-info {
    font-size: 0.8rem;
    color: #908976; /* ê¸°ì¡´ë³´ë‹¤ ì•½ê°„ ë” ì˜ ë³´ì´ëŠ” ìƒ‰ìƒ */
    line-height: 1.7;
    margin-bottom: 20px;
}

.business-info strong {
    color: #7a7a5c;
    font-weight: 500;
}

.business-info p {
    margin: 0;
}

/* ê¸°ì¡´ ì €ì‘ê¶Œ í…ìŠ¤íŠ¸ì˜ í´ë˜ìŠ¤ëª…ì„ ì¶”ê°€í•˜ì—¬ ìŠ¤íƒ€ì¼ì„ ëª…í™•íˆ í•¨ */
.copyright-text {
    font-size: 0.85rem;
    color: #b2a97e;
    margin: 0;
}

    @media (max-width: 768px) {
        .footer-container {
            flex-direction: column;
            text-align: center;
        }
        .footer-about {
            max-width: 100%;
        }
        .footer-social {
            margin-bottom: 20px;
        }
        .footer-links-group {
            width: 100%;
            justify-content: space-around;
            text-align: center;
        }
            .business-info {
        font-size: 0.75rem; /* ëª¨ë°”ì¼ì—ì„œ ê¸€ì í¬ê¸° ì‚´ì§ ì¤„ì„ */
    }
    }
</style>
</head>

<body>
    
    
    <header id="main-header">
                        <a href="index.html" class="logo">
            <img src="logo.png" alt="ì˜¤í›„ì˜ ì‹ë¬¼ ë¡œê³ ">
            <span>ì˜¤í›„ì˜ ì‹ë¬¼</span>
        </a>
        <nav>
            <a href="index.html">í™ˆ</a>
            <a href="story.html">ì´ˆë¡ ì´ì•¼ê¸°</a>
            <a href="myPlant.html">ë‚˜ì˜ ì‹ë¬¼</a>
            <a href="findPlant.html">ì‹ë¬¼ ìƒë‹´ì†Œ</a>
            <a href="payment.html">êµ¬ë…í•˜ê¸°</a>
            <a href="#" class="cta-button">Login</a>
        </nav>
    </header>

    <main>
        <div id="plant-character" class="plant-character idle">
            <div class="pot">
                <div class="eyes">
                    <div class="eye"></div>
                    <div class="eye"></div>
                </div>
            </div>
            <div class="plant">
                <div class="leaf leaf-1"></div>
                <div class="leaf leaf-2"></div>
                <div class="leaf leaf-3"></div>
            </div>
        </div>


        <div class="chat-container">

        <div class="message-area" id="message-area">
          </div>
        <div class="option-area" id="option-area">
          <div class="option-buttons" id="option-buttons">
            </div>
        </div>
      </div>
    </main>

        <!-- ì‹ë¬¼ëª¨ë‹¬ -->
<div id="plant-modal-wrapper" class="modal-wrapper">
    <div id="plant-modal-content" class="plant-modal">
        <button class="close-button">&times;</button>
        <img id="plant-modal-img" src="" alt="ì¶”ì²œ ì‹ë¬¼ ì´ë¯¸ì§€">
        <div class="plant-info">
            <h2 id="plant-modal-name"></h2>
            <div id="plant-modal-difficulty" class="difficulty-rating"></div>
            <p id="plant-modal-desc"></p>
            <div class="care-guide">
                <h3>ğŸŒ¿ ê´€ë¦¬ ë°©ë²•</h3>
                <div id="plant-modal-care" class="care-details">
                    </div>
            </div>
        </div>
    </div>
</div>

    <div id="modal-wrapper" class="modal-wrapper">
        <div class="modal">
            <div class="modal-left"></div>
            <div class="modal-right">
                <button class="close-button">&times;</button>
                <!-- Login Form -->
                <div id="login-form" class="form-container">
                    <div class="form-header">
                        <a href="index.html" class="logo">ì˜¤í›„ì˜ ì‹ë¬¼</a>
                        <h2>Welcome Back</h2>
                    </div>
                    <form>
                        <div class="input-group">
                            <label for="login-email">Email</label>
                            <input type="email" id="login-email" required>
                        </div>
                        <div class="input-group">
                            <label for="login-password">Password</label>
                            <input type="password" id="login-password" required>
                        </div>
                        <button type="submit" class="cta-button">Login</button>
                    </form>
                    <p class="form-switcher">
                        Don't have an account? <a href="#" id="show-signup">Sign Up</a>
                    </p>
                </div>

                <!-- Signup Form -->
                <div id="signup-form" class="form-container" style="display: none;">
                    <div class="form-header">
                        <a href="index.html" class="logo">ì˜¤í›„ì˜ ì‹ë¬¼</a>
                        <h2>Create Account</h2>
                    </div>
                    <form>
                        <div class="input-group">
                            <label for="signup-name">Name</label>
                            <input type="text" id="signup-name" required>
                        </div>
                        <div class="input-group">
                            <label for="signup-email">Email</label>
                            <input type="email" id="signup-email" required>
                        </div>
                        <div class="input-group">
                            <label for="signup-password">Password</label>
                            <input type="password" id="signup-password" required>
                        </div>
                        <div class="agreement-group">
    <div class="checkbox-group">
        <input type="checkbox" id="signup-terms" name="terms" required>
        <label for="signup-terms">
            [í•„ìˆ˜] <a href="terms.html" target="_blank">ì´ìš©ì•½ê´€</a>ì— ë™ì˜í•©ë‹ˆë‹¤.
        </label>
    </div>
    <div class="checkbox-group">
        <input type="checkbox" id="signup-privacy" name="privacy" required>
        <label for="signup-privacy">
            [í•„ìˆ˜] <a href="privacy.html" target="_blank">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>ì— ë™ì˜í•©ë‹ˆë‹¤.
        </label>
    </div>
</div>

<button type="submit" class="cta-button">Create Account</button>
                    </form>
                    <p class="form-switcher">
                        Already have an account? <a href="#" id="show-login">Login</a>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <footer class="main-footer">
    <div class="footer-container">
        <div class="footer-about">
            <a href="index.html" class="logo">ì˜¤í›„ì˜ ì‹ë¬¼</a>
            <p>ì‹ë¬¼ê³¼ í•¨ê»˜í•˜ëŠ” ëª¨ë“  ìˆœê°„ì´ ë” í–‰ë³µí•˜ê³  ì˜ë¯¸ ìˆë„ë¡, ì˜¤í›„ì˜ ì‹ë¬¼ì´ ë‹¹ì‹ ì˜ ì´ˆë¡ë¹› ì—¬ì •ì— í•¨ê»˜í•©ë‹ˆë‹¤.</p>
            <div class="footer-social">
                <a href="https://www.instagram.com/plantnoon/" target="_blank">Instagram</a>
                <a href="https://blog.naver.com/happy_care_service/223955159263" target="_blank">Blog</a>
                <a href="https://open.kakao.com/o/gJLPjuKh" target="_blank">Open Chat</a>
            </div>
        </div>
        <div class="footer-links-group">
            <div class="footer-links">
                <h4>Policy</h4>
                <ul>
                    <li><a href="terms.html">ì´ìš©ì•½ê´€</a></li>
                    <li><a href="privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a></li>
                    <li><a href="refund.html">í™˜ë¶ˆì •ì±…</a></li>
                </ul>
            </div>
        </div>
    </div>
    <div class="footer-bottom">
        <div class="business-info">
            <p>
                <strong>ê³ í•˜ì´ì–´(GoHigher)</strong> | ëŒ€í‘œ: ë°•í•´ì§„ | ì‚¬ì—…ìë“±ë¡ë²ˆí˜¸: 407-09-54622<br>
                ì£¼ì†Œ: ëŒ€êµ¬ê´‘ì—­ì‹œ ë¶êµ¬ ë™ì²œë¡œ 155, 12ì¸µ | <br>
                ê³ ê°ì„¼í„°: 070-8010-1675 (í‰ì¼ 09:00 - 18:00) | ì´ë©”ì¼: hermann8hesse@gmail.com
            </p>
        </div>
        <p class="copyright-text">&copy; 2025 Plantnoon. All Rights Reserved.</p>
    </div>
</footer>


<nav id="bottom-nav">
  <a href="index.html" class="nav-item">
    <span class="nav-icon">ğŸ </span>
  </a>
  <a href="story.html" class="nav-item">
    <span class="nav-icon">ğŸŒ±</span>
  </a>
  <a href="myPlant.html" class="nav-item">
    <span class="nav-icon">ğŸª´</span>
  </a>
  <a href="findPlant.html" class="nav-item">
    <span class="nav-icon">ğŸ’¬</span>
  </a>
    <a href="payment.html" class="nav-item">
    <span class="nav-icon">â­</span>
  </a>
</nav>



    <script type="module" src="navigation.js"></script>

<script type="module">
    // navigation.jsì—ì„œ auth ê°ì²´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
    import { auth } from './navigation.js';
    import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

document.addEventListener('DOMContentLoaded', () => {
    const plantModalWrapper = document.getElementById('plant-modal-wrapper');
    const plantModalContent = document.getElementById('plant-modal-content');
    const closeModalButton = plantModalContent.querySelector('.close-button');
    const plantModalImg = document.getElementById('plant-modal-img');
    const plantModalName = document.getElementById('plant-modal-name');
    const plantModalDesc = document.getElementById('plant-modal-desc');
    const plantModalCare = document.getElementById('plant-modal-care');
    const plantModalDifficulty = document.getElementById('plant-modal-difficulty');
    const messageArea = document.getElementById('message-area');
    const optionButtonsContainer = document.getElementById('option-buttons');
    const plantCharacter = document.getElementById('plant-character');
    let currentStep = 0;
    const userAnswers = {};
    // ë¡œê·¸ì¸/íšŒì›ê°€ì… ëª¨ë‹¬
    const loginModalWrapper = document.getElementById('modal-wrapper');
    const loginModalCloseBtns = loginModalWrapper.querySelectorAll('.close-button');

        // ë‹«ê¸° ë²„íŠ¼(X) í´ë¦­ì‹œ ëª¨ë‹¬ ë‹«ê¸°
    loginModalCloseBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            loginModalWrapper.style.opacity = 0;
            loginModalWrapper.style.visibility = "hidden";
        });
    });

       // (ì„ íƒ) ë¡œê·¸ì¸ ë²„íŠ¼ ëˆ„ë¥´ë©´ ëª¨ë‹¬ ì—´ê¸°
    document.querySelectorAll('.cta-button').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            loginModalWrapper.style.opacity = 1;
            loginModalWrapper.style.visibility = "visible";
        });
    });
        // ë°”ê¹¥(ë°°ê²½) í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
    loginModalWrapper.addEventListener('click', (e) => {
        if (e.target === loginModalWrapper) { // ë°”ê¹¥ ì˜ì—­(ë°°ê²½) í´ë¦­
            loginModalWrapper.style.opacity = 0;
            loginModalWrapper.style.visibility = "hidden";
        }
    });

    
    // â–¼â–¼â–¼ 1. ë¡œê·¸ì¸ ìƒíƒœë¥¼ ì €ì¥í•  ë³€ìˆ˜ ë° ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ â–¼â–¼â–¼
    let currentUser = null;
    onAuthStateChanged(auth, (user) => {
    currentUser = user; // ë¡œê·¸ì¸ ìƒíƒœê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ currentUser ì—…ë°ì´íŠ¸
    });

    // â–¼â–¼â–¼ 'ì‚¬ì§„ìœ¼ë¡œ ì‹ë¬¼ ì´ë¦„ ì°¾ê¸°' ì˜µì…˜ ì¶”ê°€ â–¼â–¼â–¼
    const questions = [
        { 
            key: 'intro', 
            text: "ì•ˆë…•! ë§Œë‚˜ì„œ ë°˜ê°€ì›Œ. ë¬´ì—‡ì„ ë„ì™€ì¤„ê¹Œ?",
            options: [
                { text: 'ë‚˜ì—ê²Œ ë§ëŠ” ì‹ë¬¼ ì¶”ì²œë°›ê¸° ğŸŒ¿', value: 'start_recommendation' },
                { text: 'ì‚¬ì§„ìœ¼ë¡œ ì‹ë¬¼ ì´ë¦„ ì°¾ê¸° ğŸ“¸', value: 'start_identification' },
                { text: 'ì•„í”ˆ ì‹ë¬¼ ì§„ë‹¨ë°›ê¸° ğŸ©º', value: 'start_diagnosis' }
            ]
        },
        { 
            key: 'light', 
            text: "ì¢‹ì•„! ë¨¼ì €, ì‹ë¬¼ì„ ë‘˜ ê³µê°„ì˜ ë¹›ì€ ì–´ë–¤ í¸ì´ì•¼?", 
            options: [ 
                { text: 'ì°½ë¬¸ì´ ì—†ê±°ë‚˜ ë©€ì–´ (ì–´ë‘ìš´ í¸)', value: 'low' }, 
                { text: 'í–‡ë¹› ë“œëŠ” ì°½ê°€ ê·¼ì²˜ (ë°ì€ í¸)', value: 'medium' }, 
                { text: 'ì§ì‚¬ê´‘ì„ ì´ 4ì‹œê°„ ì´ìƒ (ë§¤ìš° ë°ìŒ)', value: 'high' } 
            ] 
        },
        {
            key: 'space',
            text: "ì‹ë¬¼ì„ ë†“ì„ ê³µê°„ì€ ì–¼ë§ˆë‚˜ ë„“ì–´?",
            options: [
                { text: 'ì±…ìƒì´ë‚˜ ì„ ë°˜ ìœ„ (ì†Œí˜•)', value: 'small'},
                { text: 'ë°”ë‹¥ì— ë‘˜ ê³µê°„ (ì¤‘í˜•)', value: 'medium'},
                { text: 'ë„“ì€ ê±°ì‹¤ í•œ ì¼  (ëŒ€í˜•)', value: 'large'}
            ]
        },
        {
            key: 'purpose',
            text: 'ì‹ë¬¼ì„ í‚¤ìš°ë ¤ëŠ” ì£¼ëœ ì´ìœ ê°€ ë­ì•¼?',
            options: [
                { text: 'ì¸í…Œë¦¬ì–´ íš¨ê³¼! ğŸŒ¿', value: 'interior' },
                { text: 'ê³µê¸° ì •í™” ëŠ¥ë ¥', value: 'air_purification' },
                { text: 'ì²˜ìŒì´ë¼ í‚¤ìš°ê¸° ì‰¬ìš´ ì‹ë¬¼', value: 'beginner' },
                { text: 'ì˜ˆìœ ê½ƒì„ ë³´ê³  ì‹¶ì–´ ğŸŒ¸', value: 'flowering' }
            ]
        },
        { 
            key: 'pet', 
            text: "í˜¹ì‹œ ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜ ì‚´ê³  ìˆì–´? ğŸ¶", 
            options: [ 
                { text: 'ì‘, ê°™ì´ ì‚´ì•„!', value: 'yes' }, 
                { text: 'ì•„ë‹ˆ, ì—†ì–´.', value: 'no' }, 
            ] 
        },
        { 
            key: 'watering_style', 
            text: "ë§ˆì§€ë§‰! ë„ˆì˜ ë¬¼ì£¼ê¸° ìŠ¤íƒ€ì¼ì€ ì–´ë•Œ?", 
            options: [ 
                { text: 'ê¹œë¹¡ ìŠì„ ë•Œê°€ ë§ì•„ (ê±´ì¡°í•˜ê²Œ)', value: 'low' }, 
                { text: 'ê¼¬ë°•ê¼¬ë°• ì±™ê²¨ì£¼ëŠ” í¸ (ë³´í†µ)', value: 'medium' }, 
                { text: 'ì• ì • ë“¬ë¿! ìì£¼ ì£¼ê³  ì‹¶ì–´ (ì´‰ì´‰í•˜ê²Œ)', value: 'high' } 
            ] 
        },
        { 
            key: 'result', 
            text: "ì¢‹ì•„, ë‹¤ ëì–´! ë„ˆì˜ ì„±í–¥ì„ ë¶„ì„í•´ì„œ ë”± ë§ëŠ” ì¹œêµ¬ë“¤ì„ ì°¾ì•„ë³¼ê²Œ. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì¤˜!", 
            options: null 
        }
    ];
    // â–²â–²â–²â–²â–² ì—¬ê¸°ê¹Œì§€ ìˆ˜ì • â–²â–²â–²â–²â–²

    const plants = [
        { name: 'ì‚°ì„¸ë² ë¦¬ì•„', light: 'low', watering_style: 'low', size: 'medium', pet_friendly: false, purpose: ['air_purification', 'beginner'], difficulty: 1, image: 'findPlant/ì‚°ì„¸ë² ë¦¬ì•„.webp', description: 'ê³µê¸° ì •í™” ëŠ¥ë ¥ì´ íƒì›”í•˜ë©° ê±´ì¡°ì— ê°•í•´ ì´ˆë³´ìì—ê²Œ ì¢‹ì•„ìš”.', tip: 'ë¬¼ì„ ë„ˆë¬´ ìì£¼ ì£¼ë©´ ë¿Œë¦¬ê°€ ì©ì„ ìˆ˜ ìˆì–´ìš”. í™ì´ ì™„ì „íˆ ë§ˆë¥¸ ê²ƒì„ í™•ì¸í•œ í›„ì— ë¬¼ì„ ì£¼ì„¸ìš”.' },
        { name: 'ìŠ¤í‚¨ë‹µì„œìŠ¤', light: 'low', watering_style: 'medium', size: 'small', pet_friendly: false, purpose: ['beginner', 'air_purification'], difficulty: 1, image: 'findPlant/ìŠ¤í‚¨ë‹µì„œìŠ¤.webp', description: 'ìƒëª…ë ¥ì´ ê°•í•´ ì–´ë””ì„œë“  ì˜ ìë¼ëŠ” ë©êµ´ ì‹ë¬¼ì´ì—ìš”.', tip: 'ì ëì´ ë…¸ë—ê²Œ ë³€í•˜ë©´ ê³¼ìŠµì˜ ì‹ í˜¸ì¼ ìˆ˜ ìˆì–´ìš”.' },
        { name: 'ëª¬ìŠ¤í…Œë¼', light: 'medium', watering_style: 'medium', size: 'large', pet_friendly: false, purpose: ['interior', 'air_purification'], difficulty: 2, image: 'findPlant/ëª¬ìŠ¤í…Œë¼.webp', description: 'ë©‹ì§„ ì ëª¨ì–‘ìœ¼ë¡œ ì¸í…Œë¦¬ì–´ íš¨ê³¼ê°€ ë›°ì–´ë‚œ í”Œëœí…Œë¦¬ì–´ì˜ ìƒì§•ì´ì£ .', tip: 'ìƒˆ ìì— êµ¬ë©ì´ ì—†ë‹¤ë©´, ë¹›ì´ ë¶€ì¡±í•˜ë‹¤ëŠ” ì‹ í˜¸ì¼ ìˆ˜ ìˆì–´ìš”.' },
        { name: 'ì„ ì¸ì¥', light: 'high', watering_style: 'low', size: 'small', pet_friendly: true, purpose: ['beginner', 'interior'], difficulty: 2, image: 'findPlant/ì„ ì¸ì¥.webp', description: 'ê°•í•œ í–‡ë¹›ì„ ì¢‹ì•„í•˜ê³  ë¬¼ì„ ìì£¼ ì£¼ì§€ ì•Šì•„ë„ ê´œì°®ì•„ìš”.', tip: 'ì—¬ë¦„ ì„±ì¥ê¸°ì—ëŠ” í•œ ë‹¬ì— í•œ ë²ˆ, ê²¨ìš¸ íœ´ë©´ê¸°ì—ëŠ” ë¬¼ì„ ê±°ì˜ ì£¼ì§€ ì•Šì•„ë„ ë¼ìš”.' },
        { name: 'ì¹¼ë¼í…Œì•„', light: 'medium', watering_style: 'high', size: 'medium', pet_friendly: true, purpose: ['interior'], difficulty: 4, image: 'findPlant/ì¹¼ë¼í…Œì•„.webp', description: 'ì•„ë¦„ë‹¤ìš´ ì ë¬´ëŠ¬ë¥¼ ê°€ì¡Œì§€ë§Œ, ê¾¸ì¤€í•œ ìŠµë„ ê´€ë¦¬ê°€ í•„ìš”í•´ìš”.', tip: 'ìˆ˜ë—ë¬¼ë³´ë‹¤ëŠ” ì •ìˆ˜ëœ ë¬¼ì„ ì£¼ë©´ ì ëì´ íƒ€ëŠ” ê²ƒì„ ì˜ˆë°©í•  ìˆ˜ ìˆì–´ìš”.' },
        { name: 'ìŠ¤íŒŒí‹°í•„ë¦„', light: 'low', watering_style: 'high', size: 'medium', pet_friendly: false, purpose: ['air_purification', 'flowering'], difficulty: 2, image: 'findPlant/ìŠ¤íŒŒí‹°í•„ë¦„.webp', description: 'ìš°ì•„í•œ í°ìƒ‰ ê½ƒì´ í”¼ê³ , ì‹¤ë‚´ ê³µê¸° ì •í™”ì— íƒì›”í•´ìš”.', tip: 'ìì´ ì¶• ì²˜ì§€ë©´ ë¬¼ì´ í•„ìš”í•˜ë‹¤ëŠ” ì‹ í˜¸ëë‹ˆë‹¤. ë¬¼ì„ ì£¼ë©´ ê¸ˆë°© ë‹¤ì‹œ ìŒ©ìŒ©í•´ì ¸ìš”.' },
        { name: 'ê±°ë¯¸ ì‹ë¬¼', light: 'medium', watering_style: 'medium', size: 'medium', pet_friendly: true, purpose: ['beginner', 'air_purification'], difficulty: 1, image: 'findPlant/ê±°ë¯¸ì‹ë¬¼.webp', description: 'ìƒˆë¼ ì‹ë¬¼ì´ ë‹¬ë¦¬ëŠ” ëª¨ìŠµì´ ë…íŠ¹í•˜ë©°, í‚¤ìš°ê¸° ì •ë§ ì‰¬ì›Œìš”.', tip: 'ìë¼ë‚˜ëŠ” ìƒˆë¼ ì‹ë¬¼ì„ ì˜ë¼ ë¬¼ì— ê½‚ì•„ë‘ë©´ ì‰½ê²Œ ë²ˆì‹ì‹œí‚¬ ìˆ˜ ìˆì–´ìš”.' },
        { name: 'ë³´ìŠ¤í„´ ê³ ì‚¬ë¦¬', light: 'medium', watering_style: 'high', size: 'medium', pet_friendly: true, purpose: ['interior'], difficulty: 3, image: 'findPlant/ë³´ìŠ¤í„´ê³ ì‚¬ë¦¬.webp', description: 'í’ì„±í•œ ìì´ ë§¤ë ¥ì ì´ë©°, ì´‰ì´‰í•œ í™˜ê²½ì„ ì¢‹ì•„í•´ìš”.', tip: 'ê±´ì¡°í•œ ì‹¤ë‚´ í™˜ê²½ì—ì„œëŠ” ì ì£¼ë³€ì— ìì£¼ ë¶„ë¬´í•´ì£¼ë©´ ì¢‹ìŠµë‹ˆë‹¤.' },
        { name: 'ê¸ˆì „ìˆ˜(ZZ Plant)', light: 'low', watering_style: 'low', size: 'large', pet_friendly: false, purpose: ['beginner', 'air_purification'], difficulty: 1, image: 'findPlant/ê¸ˆì „ìˆ˜.webp', description: 'ë¹›ì´ ì ì€ ê³³ì—ì„œë„ ì˜ ìë¼ë©°, ë¬¼ì„ ìì£¼ ì£¼ì§€ ì•Šì•„ë„ ë˜ì–´ ê´€ë¦¬ê°€ í¸í•´ìš”.', tip: 'ëˆì„ ë¶ˆëŸ¬ì˜¨ë‹¤ëŠ” ì†ì„¤ì´ ìˆì–´ ê°œì—… ì„ ë¬¼ë¡œ ì¸ê¸°ê°€ ë§ì•„ìš”.' },
        { name: 'ì—¬ì¸ì´ˆ', light: 'medium', watering_style: 'medium', size: 'large', pet_friendly: true, purpose: ['interior', 'beginner'], difficulty: 2, image: 'findPlant/ì—¬ì¸ì´ˆ.webp', description: 'ë„“ê³  ì‹œì›í•œ ìì´ ë§¤ë ¥ì ì¸ ì‹ë¬¼ë¡œ, ì´êµ­ì ì¸ ë¶„ìœ„ê¸°ë¥¼ ì—°ì¶œí•´ìš”.', tip: 'ìì´ ë§ˆë¥´ì§€ ì•Šë„ë¡ ì£¼ë³€ì— ë¶„ë¬´í•´ì£¼ë©´ ë” ê±´ê°•í•˜ê²Œ ìë¼ìš”.' },
        { name: 'ì•„ë ˆì¹´ì•¼ì', light: 'medium', watering_style: 'high', size: 'large', pet_friendly: true, purpose: ['air_purification', 'interior'], difficulty: 3, image: 'findPlant/ì•„ë ˆì¹´ì•¼ì.webp', description: 'NASAê°€ ì„ ì •í•œ ì‹¤ë‚´ ê³µê¸°ì •í™” ì‹ë¬¼ 1ìœ„! ê°€ìŠµ íš¨ê³¼ë„ ë›°ì–´ë‚˜ìš”.', tip: 'ë¬¼ì„ ì¤„ ë•ŒëŠ” ê²‰í™ì´ ë§ëì„ ë•Œ í ë»‘ ì£¼ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.' },
        { name: 'í•„ë ˆì•„ í˜í˜ë¡œë¯¸ì˜¤ì´ë°ìŠ¤', light: 'medium', watering_style: 'medium', size: 'small', pet_friendly: true, purpose: ['interior', 'beginner'], difficulty: 2, image: 'findPlant/í•„ë ˆì•„í˜í˜.webp', description: 'ë™ê¸€ë™ê¸€í•œ ìì´ ê·€ì—¬ì›Œ ì¸ê¸°ê°€ ë§ê³  ë²ˆì‹ë ¥ì´ ì¢‹ì€ ì‹ë¬¼ì…ë‹ˆë‹¤.', tip: 'ìƒˆë¡œìš´ ìì´ ì˜ ë‚˜ë„ë¡ ì£¼ê¸°ì ìœ¼ë¡œ í™”ë¶„ì„ ëŒë ¤ ë¹›ì„ ê³¨ê³ ë£¨ ë°›ê²Œ í•´ì£¼ì„¸ìš”.' },
        { name: 'ì•ˆìŠ¤ë¦¬ì›€', light: 'medium', watering_style: 'high', size: 'medium', pet_friendly: false, purpose: ['flowering', 'interior'], difficulty: 3, image: 'findPlant/ì•ˆìŠ¤ë¦¬ì›€.webp', description: 'í•˜íŠ¸ ëª¨ì–‘ì˜ í¬ì—½ê³¼ ë…íŠ¹í•œ ê½ƒì´ 1ë…„ ë‚´ë‚´ í”¼ê³  ì§€ëŠ” ì‹ë¬¼ì´ì—ìš”.', tip: 'ë°˜ë ¤ë™ë¬¼ì—ê²ŒëŠ” ë…ì„±ì´ ìˆìœ¼ë‹ˆ ì„­ì·¨í•˜ì§€ ì•Šë„ë¡ ì£¼ì˜ê°€ í•„ìš”í•´ìš”.' },
        { name: 'ê³ ë¬´ë‚˜ë¬´', light: 'medium', watering_style: 'low', size: 'large', pet_friendly: false, purpose: ['air_purification', 'beginner'], difficulty: 2, image: 'findPlant/ê³ ë¬´ë‚˜ë¬´.webp', description: 'ê´‘íƒ ìˆëŠ” ì§™ì€ ìì´ ê³ ê¸‰ìŠ¤ëŸ¬ìš°ë©°, í™˜ê²½ ì ì‘ë ¥ì´ ë›°ì–´ë‚˜ìš”.', tip: 'ìì— ë¨¼ì§€ê°€ ìŒ“ì´ë©´ ì –ì€ ì²œìœ¼ë¡œ ë‹¦ì•„ì£¼ë©´ ê´‘í•©ì„±ì— ë„ì›€ì´ ë©ë‹ˆë‹¤.' }
    ];

   // â–¼â–¼â–¼ 2. AI ë‹µë³€ ì¤„ ë°”ê¿ˆ ì²˜ë¦¬ë¥¼ ìœ„í•´ ìˆ˜ì •ëœ í•¨ìˆ˜ â–¼â–¼â–¼
    function addMessage(text, sender, contentHTML = null) {
        const bubble = document.createElement('div');
        bubble.className = `message-bubble ${sender}-message`;
        if (contentHTML) {
            bubble.innerHTML = contentHTML;
        } else {
            // ë§ˆí¬ë‹¤ìš´(**)ê³¼ ì¤„ë°”ê¿ˆ(\n)ì„ ëª¨ë‘ HTML íƒœê·¸ë¡œ ë³€í™˜
            bubble.innerHTML = text.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\n/g, '<br>');
        }
        messageArea.appendChild(bubble);
        messageArea.scrollTop = messageArea.scrollHeight;
        return bubble;
    }

    function showTypingIndicator() {
        plantCharacter.className = 'plant-character thinking';
        const indicator = document.createElement('div');
        indicator.className = 'typing-indicator plant-message';
        indicator.innerHTML = '<span></span><span></span><span></span>';
        messageArea.appendChild(indicator);
        messageArea.scrollTop = messageArea.scrollHeight;
        return indicator;
    }

    function askQuestion() {
        const question = questions[currentStep];
        const indicator = showTypingIndicator();

        setTimeout(() => {
            messageArea.removeChild(indicator);
            addMessage(question.text, 'plant');
            
            if (question.key !== 'result') {
                plantCharacter.className = 'plant-character idle';
            }

            if (question.key === 'result') {
                showResults();
            } else {
                renderOptions(question.options);
            }
        }, 1200);
    }
    
    function renderOptions(options) {
        optionButtonsContainer.innerHTML = '';
        if (!options) return;
        options.forEach(opt => {
            const button = document.createElement('button');
            button.textContent = opt.text;
            button.dataset.value = opt.value;
            button.addEventListener('click', () => handleOptionClick(opt));
            optionButtonsContainer.appendChild(button);
        });
    }

        // â–¼â–¼â–¼ 2. í•¨ìˆ˜ ì‹œì‘ ë¶€ë¶„ì— ë¡œê·¸ì¸ í™•ì¸ ë¡œì§ ì¶”ê°€ â–¼â–¼â–¼
        function handleOptionClick(option) {
            // ëŒ€í™”ì˜ ì²« ë‹¨ê³„(currentStep === 0)ì´ê³ , ë¡œê·¸ì¸ì´ ë˜ì–´ìˆì§€ ì•Šë‹¤ë©´
            if (currentStep === 0 && !currentUser) {
                document.querySelector('.cta-button').click(); // í—¤ë”ì˜ ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­
                return; // í•¨ìˆ˜ ì‹¤í–‰ ì¤‘ë‹¨
            }

        addMessage(option.text, 'user');
        userAnswers[questions[currentStep].key] = option.value;
        optionButtonsContainer.innerHTML = '';

        if (option.value === 'start_identification') {
            startImageIdentification();
            return;
        } else if (option.value === 'start_diagnosis') { // <-- ë¶„ê¸° ì¶”ê°€
            startImageDiagnosis(); // <-- ìƒˆë¡œìš´ ì§„ë‹¨ ì‹œì‘ í•¨ìˆ˜ í˜¸ì¶œ
            return;
        }
        
        // ê¸°ì¡´ ì¶”ì²œ ë¡œì§
        const currentKey = questions[currentStep].key;
        const reactions = {
            light: "ë¹›ì€ ì‹ë¬¼ì—ê²Œ ì •ë§ ì¤‘ìš”í•˜ì§€! ì•Œì•˜ì–´. â˜€ï¸",
            space: "ê³µê°„ í¬ê¸°ë¥¼ ê°€ëŠ í•´ë³´ëŠ” ì¤‘... ğŸ¤”",
            purpose: "ê·¸ë ‡êµ¬ë‚˜! ì¢‹ì€ ëª©í‘œë¥¼ ê°€ì¡Œë„¤. ğŸ‘",
            pet: "ì•Œë ¤ì¤˜ì„œ ê³ ë§ˆì›Œ! ì•ˆì „ì´ ìµœìš°ì„ ì´ì§€. ğŸ¾",
            watering_style: "ë¬¼ì£¼ê¸° ìŠ¤íƒ€ì¼ë„ ì•„ì£¼ ì¤‘ìš”í•œ ì •ë³´ì•¼! ğŸ’§"
        };
        
        if (reactions[currentKey]) {
            setTimeout(() => {
                addMessage(reactions[currentKey], 'plant');
                proceedToNextStep();
            }, 500);
        } else {
            proceedToNextStep();
        }
    }

    function proceedToNextStep() {
        currentStep++;
        if (currentStep < questions.length) {
            askQuestion();
        }
    }
    
    
        // â–¼â–¼â–¼ ì‚¬ì§„ìœ¼ë¡œ ì°¾ê¸° ê´€ë ¨ í•¨ìˆ˜ë“¤ ì¶”ê°€ â–¼â–¼â–¼
    
    // 1. ì‚¬ì§„ ì—…ë¡œë“œ ì•ˆë‚´ ë° ë²„íŠ¼ ìƒì„±
    function startImageIdentification() {
        addMessage("ì¢‹ì•„! ê¶ê¸ˆí•œ ì‹ë¬¼ ì‚¬ì§„ì„ ì˜¬ë ¤ì¤˜.", 'plant');
        
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = 'image/*';
        fileInput.style.display = 'none';
        
        fileInput.addEventListener('change', handleImageUpload);
        
        const uploadButton = document.createElement('button');
        uploadButton.textContent = 'ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ ì‚¬ì§„ ì„ íƒí•˜ê¸°';
        uploadButton.onclick = () => fileInput.click();
        
        optionButtonsContainer.appendChild(uploadButton);
        document.body.appendChild(fileInput);
    }

    // 2. ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬ ë° API í˜¸ì¶œ
    async function handleImageUpload(event) {
        const file = event.target.files[0];
        if (!file) return;

        optionButtonsContainer.innerHTML = '';
        addMessage("ì‚¬ì§„ì„ ë¶„ì„í•˜ê³  ìˆì–´. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì¤˜! ğŸŒ±", 'plant');

        setTimeout(() => {
            addMessage("ìŒ... ì ê¹ë§Œ! ê±°ì˜ ë‹¤ ëì–´! ğŸ§", 'plant');
            
            const indicator = showTypingIndicator();

            resizeImage(file).then(compressedBlob => {
                const reader = new FileReader();
                reader.readAsDataURL(compressedBlob);
                reader.onloadend = async () => {
                    const base64Image = reader.result.split(',')[1];
                    try {
                        // â–¼â–¼â–¼ fetch ëŒ€ì‹  fetchWithRetry ì‚¬ìš© â–¼â–¼â–¼
                        const response = await fetchWithRetry('/api/identify', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ image: base64Image, mimeType: compressedBlob.type })
                        });
                        // â–²â–²â–² fetch ëŒ€ì‹  fetchWithRetry ì‚¬ìš© â–²â–²â–²

                        indicator.remove();
                        if (!response.ok) {
                            const errorData = await response.json();
                            throw new Error(errorData.error || `ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.statusText}`);
                        }
                        const data = await response.json();
                        addMessage(data.identification, 'plant');
                    } catch (apiError) {
                        console.error("API í˜¸ì¶œ ì˜¤ë¥˜:", apiError);
                        indicator.remove();
                        addMessage(`ì´ëŸ°, ì‚¬ì§„ì„ ë¶„ì„í•˜ëŠ” ì¤‘ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´.\n(${apiError.message})`, 'plant');
                    } finally {
                        showRestartButton();
                    }
                };
            }).catch(resizeError => {
                console.error("ì´ë¯¸ì§€ ì²˜ë¦¬ ì˜¤ë¥˜:", resizeError);
                indicator.remove();
                addMessage("ì‚¬ì§„ íŒŒì¼ì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆì–´. ë‹¤ì‹œ ì‹œë„í•´ ì¤„ë˜?", 'plant');
                showRestartButton();
            });
        }, 1500);
    }

    // â–¼â–¼â–¼ ìƒˆë¡œ ì¶”ê°€í•  ìë™ ì¬ì‹œë„ í•¨ìˆ˜ â–¼â–¼â–¼
    function fetchWithRetry(url, options, retries = 3, delay = 1500) {
        return new Promise((resolve, reject) => {
            const attemptFetch = (n) => {
                fetch(url, options)
                    .then(response => {
                        // 503 ì„œë²„ ê³¼ë¶€í•˜ ì˜¤ë¥˜ì´ê³  ì¬ì‹œë„ íšŸìˆ˜ê°€ ë‚¨ì•˜ì„ ê²½ìš°
                        if (response.status === 503 && n > 0) {
                            console.log(`ì„œë²„ ê³¼ë¶€í•˜ ê°ì§€. ${delay/1000}ì´ˆ í›„ ë‹¤ì‹œ ì‹œë„í•©ë‹ˆë‹¤... (ë‚¨ì€ íšŸìˆ˜: ${n-1})`);
                            setTimeout(() => attemptFetch(n - 1), delay);
                        } else {
                            resolve(response); // ì„±ê³µ ë˜ëŠ” ë‹¤ë¥¸ ì˜¤ë¥˜ëŠ” ì¦‰ì‹œ ë°˜í™˜
                        }
                    })
                    .catch(error => {
                        if (n > 0) {
                            setTimeout(() => attemptFetch(n - 1), delay);
                        } else {
                            reject(error);
                        }
                    });
            };
            attemptFetch(retries);
        });
    }

    // â–¼â–¼â–¼â–¼â–¼ ìƒˆë¡œ ì¶”ê°€í•  ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§• í•¨ìˆ˜ â–¼â–¼â–¼â–¼â–¼
    function resizeImage(file) {
        return new Promise(resolve => {
            const MAX_WIDTH = 800; // ì´ë¯¸ì§€ì˜ ìµœëŒ€ ê°€ë¡œ í¬ê¸°ë¥¼ 800pxë¡œ ì œí•œ
            const reader = new FileReader();
            reader.readAsDataURL(file);
            reader.onload = (event) => {
                const img = new Image();
                img.src = event.target.result;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    const scale = MAX_WIDTH / img.width;
                    canvas.width = MAX_WIDTH;
                    canvas.height = img.height * scale;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    // ìº”ë²„ìŠ¤ì˜ ì´ë¯¸ì§€ë¥¼ 80% í’ˆì§ˆì˜ JPEG Blobìœ¼ë¡œ ë³€í™˜
                    canvas.toBlob((blob) => {
                        resolve(blob);
                    }, 'image/jpeg', 0.8);
                };
            };
        });
    }

       // 1. ì‹ë¬¼ ì§„ë‹¨ ì‹œì‘ ë° ì—…ë¡œë“œ ë²„íŠ¼ ìƒì„±
    function startImageDiagnosis() {
        addMessage("ì¢‹ì•„! ì§„ë‹¨ì´ í•„ìš”í•œ ì‹ë¬¼ ì‚¬ì§„ì„ ì˜¬ë ¤ì¤˜.", 'plant');
        
        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.accept = 'image/*';
        fileInput.style.display = 'none';
        
        // ì§„ë‹¨ìš© ì—…ë¡œë“œ í•¸ë“¤ëŸ¬ë¥¼ ì—°ê²°
        fileInput.addEventListener('change', handleImageUploadForDiagnosis);
        
        const uploadButton = document.createElement('button');
        uploadButton.textContent = 'ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ ì§„ë‹¨ ì‚¬ì§„ ì„ íƒí•˜ê¸°';
        uploadButton.onclick = () => fileInput.click();
        
        optionButtonsContainer.appendChild(uploadButton);
        document.body.appendChild(fileInput);
    }

    // 2. ì§„ë‹¨ìš© ì´ë¯¸ì§€ ì—…ë¡œë“œ ì²˜ë¦¬ ë° /api/diagnose í˜¸ì¶œ
    async function handleImageUploadForDiagnosis(event) {
        const file = event.target.files[0];
        if (!file) return;

        optionButtonsContainer.innerHTML = '';
        addMessage("ì‚¬ì§„ì„ ì •ë°€ ë¶„ì„í•˜ê³  ìˆì–´. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì¤˜! ğŸ©º", 'plant');

        setTimeout(() => {
            addMessage("ìŒ... ê¼¼ê¼¼íˆ ì‚´í´ë³¼ê²Œ! ê±°ì˜ ë‹¤ ëì–´! ğŸ§", 'plant');
            
            const indicator = showTypingIndicator();

            resizeImage(file).then(compressedBlob => {
                const reader = new FileReader();
                reader.readAsDataURL(compressedBlob);
                reader.onloadend = async () => {
                    const base64Image = reader.result.split(',')[1];
                    try {
                        // â–¼â–¼â–¼ fetch ëŒ€ì‹  fetchWithRetry ì‚¬ìš© â–¼â–¼â–¼
                        const response = await fetchWithRetry('/api/diagnose', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ image: base64Image, mimeType: compressedBlob.type })
                        });
                        // â–²â–²â–² fetch ëŒ€ì‹  fetchWithRetry ì‚¬ìš© â–²â–²â–²
                        
                        indicator.remove();
                        if (!response.ok) {
                            const errorData = await response.json();
                            throw new Error(errorData.error || `ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.statusText}`);
                        }
                        const data = await response.json();
                        addMessage(data.diagnosis, 'plant');
                    } catch (apiError) {
                        console.error("API í˜¸ì¶œ ì˜¤ë¥˜:", apiError);
                        indicator.remove();
                        addMessage(`ì´ëŸ°, ì§„ë‹¨í•˜ëŠ” ì¤‘ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì–´.\n(${apiError.message})`, 'plant');
                    } finally {
                        showRestartButton();
                    }
                };
            }).catch(resizeError => {
                console.error("ì´ë¯¸ì§€ ì²˜ë¦¬ ì˜¤ë¥˜:", resizeError);
                indicator.remove();
                addMessage("ì‚¬ì§„ íŒŒì¼ì„ ì²˜ë¦¬í•˜ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆì–´. ë‹¤ì‹œ ì‹œë„í•´ ì¤„ë˜?", 'plant');
                showRestartButton();
            });
        }, 1500);
    }
    
    // 3. ë‹¤ì‹œí•˜ê¸° ë²„íŠ¼ í‘œì‹œ (ê³µí†µ ì‚¬ìš©)
    function showRestartButton() {
        setTimeout(() => {
            const restartButton = document.createElement('button');
            restartButton.textContent = 'ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°';
            restartButton.addEventListener('click', () => {
                messageArea.innerHTML = '';
                currentStep = 0;
                Object.keys(userAnswers).forEach(k => delete userAnswers[k]);
                plantCharacter.className = 'plant-character idle';
                askQuestion();
            });
            optionButtonsContainer.innerHTML = '';
            optionButtonsContainer.appendChild(restartButton);
        }, 1000);
    }


    function showResults() {
        const filteredByPet = userAnswers.pet === 'yes' ? plants.filter(plant => plant.pet_friendly) : plants;
        const rankedPlants = filteredByPet.map(plant => {
            let score = 0;
            if (plant.light === userAnswers.light) { score += 5; } 
            else if ((userAnswers.light === 'high' && plant.light === 'low') || (userAnswers.light === 'low' && plant.light === 'high')) { score -= 5; }
            if (plant.watering_style === userAnswers.watering_style) score += 3;
            if (plant.purpose.includes(userAnswers.purpose)) score += 2;
            if (plant.size === userAnswers.space) score += 1;
            return { ...plant, score };
        }).sort((a, b) => b.score - a.score);
        
        const topPlants = rankedPlants.slice(0, 2);

        if (topPlants.length === 0 || topPlants[0].score < 1) { 
            plantCharacter.className = 'plant-character idle';
            addMessage("ì•„ì‰½ê²Œë„ ëª¨ë“  ì¡°ê±´ì— ë”± ë§ëŠ” ì¹œêµ¬ë¥¼ ì°¾ì§€ ëª»í–ˆì–´. ì¡°ê±´ì„ ì¡°ê¸ˆ ë°”ê¿”ì„œ ë‹¤ì‹œ ì‹œë„í•´ë³¼ë˜?", 'plant');
        } else {
            plantCharacter.className = 'plant-character happy';
            addMessage("ë„ˆì—ê²Œ ì–´ìš¸ë¦¬ëŠ” ì‹ë¬¼ ì¹œêµ¬ë“¤ì„ ì°¾ì•˜ì–´!", 'plant');
            topPlants.forEach(p => {
                let reason = '';
                if (p.light === userAnswers.light) reason = 'ë¹› ì¡°ê±´ì´ ë”± ë§ê³ , ';
                else if (p.purpose.includes(userAnswers.purpose)) reason = 'ì›í•˜ëŠ” ëª©ì ì— ì˜ ë§ê³ , ';
                
                const contentHTML = `<div class="result-card-wrapper"><img src="${p.image}" alt="${p.name}"><h3>${p.name}</h3><p>${reason}${p.description.substring(0, 30)}...</p></div>`;
                
                const cardBubble = addMessage(null, 'plant', contentHTML);
                cardBubble.querySelector('.result-card-wrapper').addEventListener('click', () => {
                    openPlantDetailModal(p);
                });
            });
        }
        showRestartButton();
    }


    function openPlantDetailModal(plant) {
        plantModalImg.src = plant.image;
        plantModalImg.alt = plant.name;
        plantModalName.textContent = plant.name;
        plantModalDesc.textContent = plant.description;

        let starsHTML = '<span class="difficulty-label">ë‚œì´ë„</span>'; 
        for (let i = 1; i <= 5; i++) {
            starsHTML += `<span class="star ${i <= plant.difficulty ? 'filled' : 'empty'}">${i <= plant.difficulty ? 'â˜…' : 'â˜†'}</span>`;
        }
        plantModalDifficulty.innerHTML = starsHTML;

        const careInfo = {
            'â˜€ï¸ ë¹›': { 'low': 'ì–´ë‘ìš´ ê³³ ì„ í˜¸', 'medium': 'ë°ì€ ê°„ì ‘ê´‘', 'high': 'ì§ì‚¬ê´‘ì„  í•„ìš”' }[plant.light],
            'ğŸ’§ ë¬¼ì£¼ê¸°': { 'low': 'ê±´ì¡°í•˜ê²Œ ê´€ë¦¬', 'medium': 'í™ ë§ˆë¥´ë©´ ë“¬ë¿', 'high': 'í•­ìƒ ì´‰ì´‰í•˜ê²Œ' }[plant.watering_style],
            'ğŸ“ í¬ê¸°': { 'small': 'ì†Œí˜•', 'medium': 'ì¤‘í˜•', 'large': 'ëŒ€í˜•' }[plant.size],
            'ğŸ¾ ë°˜ë ¤ë™ë¬¼': plant.pet_friendly ? 'ì•ˆì „í•´ìš”' : 'ì£¼ì˜ í•„ìš”'
        };

        plantModalCare.innerHTML = '';
        for (const [key, value] of Object.entries(careInfo)) {
            const item = document.createElement('div');
            item.className = 'care-item';
            const icon = key.split(' ')[0];
            const title = key.split(' ')[1];
            item.innerHTML = `<span>${icon}</span> <div><strong>${title}</strong><br>${value}</div>`;
            plantModalCare.appendChild(item);
        }

        if (plant.tip) {
            const tipItem = document.createElement('div');
            tipItem.className = 'care-item';
            tipItem.style.gridColumn = '1 / -1';
            tipItem.innerHTML = `<span>ğŸ’¡</span> <div><strong>Pro Tip</strong><br>${plant.tip}</div>`;
            plantModalCare.appendChild(tipItem);
        }
        
        plantModalWrapper.classList.add('visible');
    }

    function closePlantDetailModal() {
        plantModalWrapper.classList.remove('visible');
    }
    closeModalButton.addEventListener('click', closePlantDetailModal);
    plantModalWrapper.addEventListener('click', (e) => {
        if (e.target === plantModalWrapper) {
            closePlantDetailModal();
        }
    });

    askQuestion();
});
</script>
</body>
</html>
